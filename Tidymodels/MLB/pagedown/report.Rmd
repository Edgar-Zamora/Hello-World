---
author: "Yihui Xie and Romain Lesur"
date: "`r Sys.Date()`"
output:
  pagedown::html_paged:
    toc: false
    self_contained: true
    css:
     - css/custom-page.css
     - css/custom.css
editor_options: 
  chunk_output_type: console
---


```{r data, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}

# Load packages
library(tidyverse)
library(janitor)
library(pagedown)
#devtools::install_github("IvoVillanueva/mlbstatsR")
library(mlbstatsR)


# Header information
sea_meta_info <- mlbstatsR::get_mlb_teams() |> 
  filter(name == "Seattle Mariners") |> 
  tibble() |> 
  select(name, liga, division, logo, primary, secondary, tertiary) |> 
  rename(
    team_name = name,
    league = liga
  )


# Attendance Data
attendence <- read_csv("~/Desktop/Personal Projects/my-work/Tidymodels/MLB/data/game_data.csv")

attendence |> 
  filter(season == "2019",
         away_home == "home") |>
  mutate(gm_number = row_number()) |> 
  select(gm_number, attendance) |> 
  ggplot(aes(gm_number, attendance)) +
  geom_line(size = 1, color = "#005C5C") +
  labs(
    x = "",
    y = ""
  ) +
  scale_y_continuous(labels = scales::label_number(suffix = "K", scale = 1/1000)) +
  theme(
    panel.grid = element_blank(),
    panel.background = element_blank(),
    axis.ticks = element_blank(),
    axis.text = element_text(color = "black")
  )
  

attendence |> 
  filter(away_home == "home",
         season %in% c(2019:2012)) |> 
  group_by(season) |> 
  summarise(
    avg_season_attendence = mean(attendance, na.rm = TRUE)
  ) |> 
  ggplot(aes(avg_season_attendence, factor(season))) +
  geom_col(width = .6) +
  labs(
    x = "",
    y = ""
  ) +
  scale_x_continuous(labels = scales::label_number(suffix = "K", scale = 1/1000),
                     limits = c(0, 30000)) +
  theme(
    axis.ticks = element_blank(),
    axis.text = element_text(colour = "black"),
    panel.grid = element_blank(),
    panel.background = element_blank()
  )


```


<div class='header'>
<img id='team-logo' src='https://www.mlbstatic.com/team-logos/team-cap-on-light/136.svg' > <span id='header-title'> 2022 Attendance Report </span>
</div>

